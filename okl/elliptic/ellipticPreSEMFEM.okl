@kernel void preSEMFEM(
  const dlong numRows,
  @restrict const long long* dof_map,
  @restrict const dfloat* w,
  @restrict dfloat* buffer
)
{
  for(dlong localRow = 0; localRow < numRows; ++localRow; @tile(p_blockSize, @outer, @inner))
  {
    if(localRow < numRows){
      buffer[localRow] = w[dof_map[localRow]];
    }
  }
}